#!/bin/env python
import os
import argparse
import matplotlib.pyplot as plt
from ctypes import * #cdll

from scipy.io import loadmat
from .spl.filtfilt import sosgfilt

if os.name == 'posix':
    libNotch = cdll.LoadLibrary("shared/libNotch.so")
else:
    raise Exception("Platform not detected!");

def Bandpass20_38(x):
    SOS = loadmat("coefficients/SOS.mat")["SOS"]
    G   = loadmat("coefficients/G.mat")["G"]
    return filtfilt.sosgfilt(SOS, G, x);

def Notch(x):
    sz = len(x)
    x_array = (c_float * sz)(*x)
    y = [0 for i in x];
    y_array = (c_float * sz)(*y)
    for i in range(sz):
        libNotch.Notch(y_array, x_array, c_int(i));
    return list(y_array);


