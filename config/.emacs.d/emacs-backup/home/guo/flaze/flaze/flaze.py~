
from __future__ import absolute_import
from __future__ import division
from __future__ import print_function

import os
from absl import app
from absl import flags
from tensor2tensor.v2 import t2t

tf.enable_v2_behavior()

FLAGS = flags.FLAGS

flags.DEFINE_string("dataset", None, "Which dataset to use.")
flags.DEFINE_string("model", None, "Which model to train")
flags.DEFINE_string("data_dir", None, "Path to the directory with data")
flags.DEFINE_string("output_dir", None, "Path to the directory to save logs and checkpoints.")
flags.DEFINE_multi_string("config_file", None, "Configuration file with parameters (.gin).")
flags.DEFINE_multi_string("config", None, "Configuration parameters (gin string).")

def main(argv):
    del argv
    data_dir, output_dir = FLAGS.data_dir, FLAGS.output_dir
    data_dir   = os.path.expanduser(data_dir) if data_dir   is not None else None
    output_dir = os.path.expanduser(data_dir) if output_dir is not None else None
    t2t.t2t_train(FLAGS.model, FLAGS.dataset,
                  data_dir=data_dir, output_dir=output_dir,
                  config_file=FLAGS.config_file, config=FLAGS.config)

if __name__ == "__main__":
    app.run(main)

