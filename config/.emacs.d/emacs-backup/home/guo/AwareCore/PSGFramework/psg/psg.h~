
#ifndef _PHYSIO_PSG_
#define _PHYSIO_PSG_

#include "awake.h"
#include "dsa.h"
#include "heart.h"
#include "movement.h"
#include "respiration.h"
#include "stage.h"
#include "utils.h"

namespace physio { 
  class Framework {
  public:
    EventQueues<int> event_queues;
    
    Framework() {
      event_queues = EventQueues();
      this->event_queues = event_queues;
      this->awake_judger = AwakeJudge(event_queues);
      this->heart_judger = HeartJudge(event_queues);
      this->move_judger  = MovementJudge(event_queues);
      this->resp_judger  = RespirationJudge(event_queues);
      this->stage_judger = StageJudge(event_queues);
    }

    int run(int ecg_la_ra,
	    int eeg_f1_m2,
	    int eeg_c3_m2,
	    int eeg_c4_m1,
	    int eeg_f2_m1,
	    int eeg_o1_m2,
	    int eeg_o2_m1,
	    int emg_pos_neg,
	    int eog_e2_m2,
	    int eog_e1_m2,
	    int leg_l,	    
	    int leg_r,
	    int resp_abdomen,
	    int resp_chest,
	    int resp_pressure,
	    int resp_thermal, 
	    int sao2_finger,
	    int trachea_sound) {
      
      awake_judger.run(eeg_f1_m2, eeg_c3_m2, eeg_c4_m1,
		       eeg_f2_m1, eeg_o1_m2, eeg_o2_m1);
      
      heart_judger.run(ecg_la_ra);
      
      move_judger.run(leg_l, leg_r);
      
      resp_judger.run(resp_abdomen,  resp_chest,
		      resp_pressure, resp_thermal);
      
      stage_judger.run(eeg_f1_m2, eeg_c3_m2, eeg_c4_m1,
		       eeg_f2_m1, eeg_o1_m2, eeg_o2_m1,
		       eog_e2_m2, eog_e1_m2, emg_pos_neg);
      return 0;
    }

  private:
    AwakeJudger        awake_judger;
    HeartJudger        heart_judger;
    MovementJudger     move_judger;
    RespirationJudger  resp_judger;
    StageJudger        stage_judger;
  };

}; //end namespace physio

#endif
