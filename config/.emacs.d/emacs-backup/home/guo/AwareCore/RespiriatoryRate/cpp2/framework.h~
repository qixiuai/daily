#ifndef _BCG_
#define _BCG_

#include <string>
#include <vector>

#include "filter.h"
#include "findpeaks.h"

class Framework {
public:
  Filter<double> lowpass;
  MedianFilter<double> medfilter;
  
  PeakDetector resp_detector;
  
  //  BCGFramework() {}
 
  Framework(int  Fz) {
    std::string data_dir = "/home/guo/AwareCore/BCGGongzhuang/cpp/coeffs/";
    std::string lowpass_a;
    std::string lowpass_b;
    if (Fz == 75) {
      lowpass_a = data_dir + "lowpass75_a.csv";
      lowpass_b = data_dir + "lowpass75_b.csv";
    } else if (Fz == 100) {
      lowpass_a = data_dir + "lowpass100_a.csv";
      lowpass_b = data_dir + "lowpass100_b.csv";
    } else {
      throw "Encounted the wrong frequency" + std::to_string(Fz) + "\n";
    }
    
    this->lowpass   = Filter<double>(lowpass_b,  lowpass_a);
    this->medfilter = MedianFilter<double>(15);
    this->resp_detector  = PeakDetector(Fz, Fz*22, 95, 0.78, 85, 21);
  }
  int run(int value);
};


#endif


