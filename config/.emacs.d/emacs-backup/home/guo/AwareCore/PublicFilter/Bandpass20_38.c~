
#include <stdio.h>

// For Fz = 500Hz 

void filter(double* y, double *x, int n, double* b, int nb, double* a, int na);

void Bandpass20_38(double*y, double*x, int n) {
  // Fz = 500Hz  
  // Den is a;
  double Den[] = {1,-3.828138e+01,7.183271e+02,-8.804360e+03,7.925217e+04,-5.585011e+05,3.207640e+06,-1.543254e+07,6.344920e+07,-2.262913e+08,7.082984e+08,-1.963705e+09,4.858152e+09,-1.079007e+10,2.162142e+10,-3.924798e+10,6.475482e+10,-9.737086e+10,1.337325e+11,-1.680508e+11,1.934640e+11,-2.042240e+11,1.977840e+11,-1.757639e+11,1.433000e+11,-1.071298e+11,7.337222e+10,-4.597800e+10,2.631609e+10,-1.372768e+10,6.508743e+09,-2.795589e+09,1.083329e+09,-3.768854e+08,1.170033e+08,-3.217389e+07,7.764650e+06,-1.625547e+06,2.908183e+05,-4.358552e+04,5.323785e+03,-5.091060e+02,3.575567e+01,-1.640343e+00,3.688798e-02};
  // Num is b;
  double Num[] = {7.173342e-22,0,-1.578135e-20,0,1.657042e-19,0,-1.104695e-18,0,5.247300e-18,0,-1.889028e-17,0,5.352246e-17,0,-1.223370e-16,0,2.293820e-16,0,-3.568164e-16,0,4.638613e-16,0,-5.060305e-16,0,4.638613e-16,0,-3.568164e-16,0,2.293820e-16,0,-1.223370e-16,0,5.352246e-17,0,-1.889028e-17,0,5.247300e-18,0,-1.104695e-18,0,1.657042e-19,0,-1.578135e-20,0,7.173342e-22};
  
  filter(y, x, n, Num, 607, Den, 1);
}


void filter(double* y, double *x, int n, double* b, int nb, double* a, int na) {
  double upper, lower;
  upper = lower = 0;
  for (int i=0; n-i>=0 && i<nb; i++) {
    upper += b[i]*x[n-i];
  }
  for (int i=1; n-i>=0 && i<na; i++) {
    lower += a[i]*y[n-i];
  }
  y[n] = upper - lower;
}

/*
int main() {

  double x[] = {1,2,3,4,5,6,7,8,9,10,11,12,13,14};
  double y[14];
  for (int i = 0; i < 14; i++) {
    Bandpass20_38(y, x, i);
  }
  for (int i = 0; i < 14; i++) {
    printf("%f\t", y[i]);
  }
}
*/
