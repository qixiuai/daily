import torch
import torch.nn as nn
import torch.nn.functional as F
import torch.optim as optim

torch.manual_seed(1)
use_cuda = False
device   = torch.device("cuda" if use_cuda else "cpu")

lstm = nn.LSTM(1, 3)
lstm = lstm.to(device)

inputs = [torch.Tensor([i]) for i in range(100)]

hidden = (torch.randn(1,1,3), torch.randn(1,1,3))

for i in inputs:
    i = i.to(device)
    out, hidden = lstm(i.view(1,1,-1), hidden)
    print(out, hidden)
    

