from parser import Parser

def parse_file(out_file, in_file):
    data = []
    out = open(out_file, 'w')
    parse_func = Parser().parse
    with open(in_file, 'rb') as file:
        for line in file:
            line = line[27:].strip()
            nums = parse_func(line)
            if len(nums) < 200:
                print(nums)
                continue
            data.extend(nums)
            for val in nums:
                out.write(str(val) + '\n')
    out.close()
    return data

def plot_data(data):
    plt.plot(data)
    plt.show()

def main(data_file):
    data = parse_file(data_file)
    plot_data(data)
    
if __name__ == '__main__':
    file = "data/heart-75-hx-10.txt"
    out = "data/heart_parsed_2.txt"
    data_dir = 'data/heart-data/'
    for filename in os.listdir(data_dir):
        file_path = os.path.join(data_dir, filename)
        out_path  = 'data/' + "parsed_" + filename
        parse_file(out_path, file_path)
