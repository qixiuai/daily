
#include "heart/heart.h"

namespace bcg {
  namespace heart {

    Heart::Heart(int fs) {
      std::string data_dir = "/home/guo/BCGHeart/embedding/data/";
      std::string b_path = data_dir + "bandpass_b_" + std::to_string(fs) + ".csv";
      std::string a_path = data_dir + "bandpass_a_" + std::to_string(fs) + ".csv";
      bandpass_filter_ = signal::LinearFilter(b_path, a_path);
      master_ = AutoPeaksMaster(fs);
    }
    
    bool Heart::push_back(float sample) {
      sample = bandpass_filter_.filter(sample);
      master_.findpeaks(sample);
      return true;
    }
    
    std::vector<uint64_t> Heart::peak_indices() {
      return master_.peak_indices();
    }
    
    std::vector<int> Heart::peak_intervals() {
      return master_.peak_intervals();
    }
    
  }
}
