
#ifndef _PHYSIO_STAGE_MODEL_
#define _PHYSIO_STAGE_MODEL_

#include <cstring>
#include <vector>
#include <iostream>
#include <memory>

#include "tensorflow/c/c_api.h"
#include "absl/strings/string_view.h"

namespace physio {
  namespace stage {
    class Model {
    public:
      Model() = default;
      Model(const absl::string_view model_dir);
      std::string predict(const std::vector<float>& spectrogram);
    private:
      TF_Session* session;
      std::string saved_model_dir;
    };
    Model::Model(const std::string model_dir) {
      saved_model_dir = model_dir;
      // load model
      
    }
    std::string Model::predict(const std::vector<float>& spectrogram) {
      return "";
    }
  }
}


#endif
