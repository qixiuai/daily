import pdb
import time
import readcsv
import codecs
path1 = '/home/guo/Github/xiaoguoguo/addrsdata/dl_dz2_no_quotes.csv'
path2 = '/home/guo/Github/xiaoguoguo/addrsdata/pcsmk_dz2_no_quotes.csv'
writePath = '/home/guo/Github/xiaoguoguo/addrsdata/result_after_datapre.csv'
t1 = time.time()
dl_addrs = readcsv.read_csv(path1,encoding='GBK')#, idMark = 'DL')#, minRecord=0, maxRecord=10000)
pcs_addrs = readcsv.read_csv(path2, encoding='UTF-8')#,idMark = 'PCS')#, minRecord=0, maxRecord=10000)
result = readcsv.read_csv(writePath, encoding='UTF-8')#, minRecord=0, maxRecord=10000)

#pdb.set_trace()
dl_addrs_dict = dict(dl_addrs)
pcs_addrs_dict = dict(pcs_addrs)
#pdb.set_trace()
with codecs.open("results_with_addrs.csv", 'w', encoding="utf-8") as out:
    for record in result:
        pcs_id, dl_id = record
        try:
            dl = dl_id + ',' + dl_addrs_dict[dl_id]
            pcs = pcs_id + ',' + pcs_addrs_dict[pcs_id]
            line = dl + ',' + pcs + '\n'
            out.write(line)
        except:
#            pdb.set_trace()
            print(record)
