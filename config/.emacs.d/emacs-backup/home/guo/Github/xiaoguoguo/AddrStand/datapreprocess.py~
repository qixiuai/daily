#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Jan 10 15:44:28 2019

@author: l1480
"""

UNIT_NAME = [0,[['一单元','1单元'],['二单元','2单元'],['三单元','3单元'],
              ['四单元','4单元'],['五单元','5单元'],['六单元','6单元'],
              ['七单元','7单元'],['八单元','8单元'],['九单元','9单元']]]
#GROUP_NUM1 = [1,[['--','-']]]
REPEART_NAME_DELETE = [1,[['--','-'],['湖镇镇','湖镇'],['村村','村'],['万田乡万田乡','万田乡'],['工业园区工业园区','工业园区'],['白云街道白云街道','白云街道'],
              ['芳村镇芳村镇','芳村镇'],['石梁镇社区石梁镇','石梁镇'],['双塔街道双塔街道','双塔街道']]]
POLISE_DELETE = [2,[['上余镇警务区上余镇','上余镇'],['峡口镇警务区峡口镇','峡口镇'],['凤林镇警务区凤林镇','凤林镇'],
              ['清湖镇警务区清湖镇','清湖镇'],['石门镇警务区石门镇','石门镇'],]]
WORD_DELETE = [3,[['社区市区','社区'],['乡社区','乡'],['村小区','村'],['苑小区','苑'],['园小区','园'],
              ['社区警务区','社区'],['街道市区','街道']]]
GROUP_SET = [UNIT_NAME,REPEART_NAME_DELETE,POLISE_DELETE,WORD_DELETE]

#SPECIAL_SAMPLE = [['湖镇镇','湖镇'],['社区市区','社区'],['一单元','1单元'],['二单元','2单元'],
#                  ['三单元','3单元'],['四单元','4单元'],['五单元','5单元'],['六单元','6单元'],['七单元','7单元'],
#                  ['八单元','8单元'],['九单元','9单元'],['乡社区','乡'],['村村','村'],['村小区','村'],['苑小区','苑'],
#                  ['园小区','园'],['社区警务区','社区'],['石梁镇社区石梁镇','石梁镇'],['双塔街道双塔街道','双塔街道'],
#                  ['--','-'],['街道市区','街道'],['上余镇警务区上余镇','上余镇'],['峡口镇警务区峡口镇','峡口镇'],
#                  ['凤林镇警务区凤林镇','凤林镇'],['清湖镇警务区清湖镇','清湖镇'],['石门镇警务区石门镇','石门镇'],
#                   ['工业园区工业园区','工业园区'],['白云街道白云街道','白云街道'],['芳村镇芳村镇','芳村镇'],['石梁镇社区石梁镇','石梁镇'],
#                  ['万田乡万田乡','万田乡']]


#
#new_detail_addr = []
#def addr_replace(detail_addr):
#    for single_addr in detail_addr:
##        num = single_addr[0]
##        single_addr = single_addr[1]
##        print('single_addr = %s'%single_addr)
##        for temp in SPECIAL_SAMPLE:
##            old_str = temp[0]
##            new_str = temp[1]
##            single_addr = single_addr.replace(old_str,new_str)
##            new_single_addr = [num,single_addr]
##        new_detail_addr.append(new_single_addr)
#        new_single_addr=single_addr_replace(single_addr)
#        new_detail_addr.append(new_single_addr)
#        detail_addr = new_detail_addr
#    return(detail_addr)

#def single_addr_replace(single_addr):
#    num = single_addr[0]
#    single_addr = single_addr[1]
#    for temp in SPECIAL_SAMPLE:
#            old_str = temp[0]
#            new_str = temp[1]
#            single_addr = single_addr.replace(old_str,new_str)
#            new_single_addr = [num,single_addr]
#    return new_single_addr
##单个地址和一个组别item替换
def addr_replace(single_addr, gn):
    '''
    一组替换一条地址
    对一组替换内容在一条地址中存在可替换的字段进行替换
        
    Args:
        single_addr: 一条详细地址
        GROUP_SET: 一个可替换字段组别
        
    Returns:
        一组替换字段后较为规范的一条具体地址
    ''' 
    for num_item in gn[1]:
        old_str = num_item[0]
        new_str = num_item[1]
#        if  str(single_addr).find != -1:
        single_addr = single_addr.replace(old_str,new_str)
    return (single_addr)

##单条地址和所有组别
def addr_replace_all_group(single_addr, GROUP_SET):
    '''
    对一条地址字段替换
    对所有替换内容的一条地址中存在可替换的字段进行替换
        
    Args:
        single_addr: 一条详细地址
        GROUP_SET: 可替换字段组别
        
    Returns:
        替换字段后较为规范的一条具体地址
    '''        
    addr_units = []
    addr_units.append(single_addr[0])
    single_addr = single_addr[1]
    for gn in GROUP_SET:
        single_addr = addr_replace(single_addr,gn)
    addr_units.append(single_addr)
    return(addr_units)
##所有地址和组别
def addrs_replace(detail_addr, GROUP_SET):
    '''
    所有地址字段替换
    对所有地址存在可替换的字段进行替换
        
    Args:
        detail_addr: 详细地址
        GROUP_SET: 可替换字段组别
        
    Returns:
        替换字段后较为规范的具体地址
    '''    
    addrs = []
    for single_addr in detail_addr:
        addr_units = addr_replace_all_group(single_addr, GROUP_SET)
        addrs.append(addr_units)
    return (addrs)
if __name__ == '__main__':
    detail_addr = [['num0','浙江省衢州市柯城区永乐乡社区白云北大道467号九单元二单元301室'],
                   ['num1','浙江省衢州市柯城区府山街道府山社区市区峡口镇警务区峡口镇人防路14--1幢2--202'],['num2','浙江省衢州市柯城区府山街道人防村村18--1--501']]
    detail_addr_new = addrs_replace(detail_addr,GROUP_SET)
        
        
        
    
    