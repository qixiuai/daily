
from __future__ import absolute_import
from __future__ import division
from __future__ import print_function

from ops import ops

from edfplus import Edfplus

# session: based on hash file
# file: filepath

class Messages(object):
    pass


class EdfFile(Messages):

    @property
    def name(self):
        return 


class ParseEdf(ops.Operation):

    def inputs(self):
        return ["session/filepath"]

    def outputs(self):
        return ["session/meta_signals"]
    
    def body(self, inputs):
        filepath = inputs[0]
        with open(filepath, "rb") as f:
            raw = f.read()
        edf = Edfplus(raw)
        meta_signals = {}
        meta_signals["num_signals"] = edf.num_signals
        meta_signals["signal_freqs"] = edf.signal_freqs
        meta_signals["starttime"] = edf.starttime
        meta_signals["signal_names"] = edf.signal_names
        meta_signals["signals"] = edf.signals
        return meta_signals

    
